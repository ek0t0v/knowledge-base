# CQS и CQRS

Основная идея **CQS** (command-query separation) в том, что в объекте методы могут быть двух типов — query (запрос) и command (команда). Запросы возвращают результат, не изменяя состояние объекта. Другими словами, у запросов нет никаких побочных эффектов. Команды изменяют состояние объекта, не возвращая значение.

Принцип **CQRS** (command-query responsibility segregation) гласит, что метод должен быть либо командой, выполняющей какое-то действие, либо запросом, возвращающим данные, но не одновременно.

Если **CQS** оперирует методами, то **CQRS** поднимается на уровень объектов. Для изменения состояния системы создается класс `Command`, а для выборки данных – класс `Query`. Таким образом, мы получаем набор объектов, которые меняют состояние системы, и набор объектов, которые возвращают данные.

Что это дает?

- Разделение на подсистемы чтения и записи позволяет выдерживать более высокую нагрузку и ее несимметричное распределение. Позволяет использовать разные (и более подходящие) БД для чтения и записи.
- На стороне чтения можно создавать таблицы с данными заточенные под потребителя, нормализация не нужна.
- Благодаря хранилищу событий мы имеем полную историю изменений, что облегчает аудит и отладку, а также позволяет "перематывать" состояние системы.

## Что почитать/посмотреть

- [Command return values](https://stackoverflow.com/questions/43433318/cqrs-command-return-values)
